# 聊吧论坛后端接口规范

用户注册需要邀请码，当以`master@talkforum.top`为邮箱注册成功时，将成为管理员且不需要邀请码

## 一、返回值标准结构

不对HttpRequest设置返回请求码，除了权限不够的情况除外（401， 403）。所有接口都应当根据返回的JSON里的success属性判断是否成功，code为对应的HTTP请求返回代码，如果res.success == false，那么data必定为null，反之不一定。

返回的时间格式为UTC字符串，用dayjs解析即可获得时间

```java
public class Result{
    private Integer code;    // 对标HTTP响应返回码
    private Boolean success; // 操作是否成功
    private String message;  // 操作反馈信息
    private Object data;     // 操作返回数据
}
```

## 二、接口规范

接口总览，其中分页大小全局约束为最大为10，分页有游标分页和传统分页两种

| 接口前缀         | 对应表                             | 核心场景                   | 权限                                          |
| ---------------- | ---------------------------------- | -------------------------- | --------------------------------------------- |
| `/auth`          | 无                                 | 登录/登出                  | 登录无Token，登出需登录态                     |
| `/users`         | users                              | 用户注册/信息管理          | 普通操作需登录，管理员带/admin                |
| `/posts`         | post                               | 帖子管理                   | 普通操作需登录，权限操作带/admin              |
| `/clubs`         | club                               | 圈子管理                   | 普通操作需登录，权限操作带/admin              |
| `/comments`      | comment                            | 评论管理                   | 普通操作需登录，权限操作带/admin              |
| `/applies`       | club_apply_create、club_apply_join | 圈子申请                   | 申请需登录，审核需权限                        |
| `/notifications` | notification                       | 通知管理                   | 仅操作自己的通知                              |
| `/reports`       | report                             | 举报提交/处理/查询         | 提交需登录，处理需管理员/风纪，查询仅本人举报 |
| `/interactions`  | interaction                        | 点赞/踩/关注操作及记录查询 | 仅登录用户操作本人互动，查询本人互动记录      |

### 1. 认证接口（/auth）finished

此接口规定了如何登录，登出，获得登录信息，判断权限等

| 路径           | 方法 | 入参                                | 出参data                                                     | 权限               | 表操作                                     |
| -------------- | ---- | ----------------------------------- | ------------------------------------------------------------ | ------------------ | ------------------------------------------ |
| `/auth/login`  | POST | email（登录邮箱）、password（密码） | id:number 当前登录用户id,<br>email:string 当前登录用户的邮箱<br>name:string 用户名 role:string 用户权限名称 <br>status:string 用户账号状态 <br>intro:string 用户的个人介绍 <br>avatarLink: string 用户头像链接 backgroundLink:string 用户背景链接 fansCount:number 用户粉丝数量 followingCount:number 用户关注数量 <br>following: number[]用户关注用户的id | 无需登录           | 生成JWT令牌，设置HttpOnlyCookie，放入Redis |
| `/auth/logout` | POST | 无（Token放HttpOnlyCookie：token）  | null                                                         | 需登录             | 清除登录Cookie，从redis移除令牌            |
| `/auth/`       | GET  | 无（Token放HttpOnlyCookie：token）  | 同`/auth/login`返回参数                                      | 需登录             | 验证登录状态，更新Token                    |
| `/auth/admin`  | GET  | 无（Token放HttpOnlyCookie：token）  | 同`/auth/login`返回参数                                      | 需风纪或管理员身份 | 验证管理员权限，更新Token                  |

#### 返回值格式示例（仅供参考）

```json
// 登录/获取用户信息成功返回
{
  "code": 200,
  "success": true,
  "message": "登录成功",
  "data": {
    "id": 1,
    "email": "user@example.com",
    "name": "用户名",
    "role": "USER",
    "status": "NORMAL",
    "intro": "个人介绍",
    "avatarLink": "https://example.com/avatar.jpg",
    "backgroundLink": "https://example.com/background.jpg",
    "fansCount": 100,
    "followingCount": 50,
    "following": [2, 3, 5]
  }
}

// 登出成功返回
{
  "code": 200,
  "success": true,
  "message": "登出成功",
  "data": null
}

// 错误返回示例
{
  "code": 401,
  "success": false,
  "message": "用户名或密码错误",
  "data": null
}
```

### 2. 用户接口（/users）

此接口定义了用户可以如何注册，修改个人信息，查询个人信息，修改密码，管理员可以修改用户的身份(role)，重置用户的密码，禁用或者取消禁用

用户身份ROLE 普通用户USER 管理员ADMIN 风纪MODERATOR，风纪仅有部分管理员权限，已被规定好

~~同一 IP 短时间内注册次数限制~~（太难了，以后再说）

#### 2.1 普通用户操作 finished

| 路径                    | 方法 | 入参                                                         | 出参                                           | 权限     | 表操作               |
| ----------------------- | ---- | ------------------------------------------------------------ | ---------------------------------------------- | -------- | -------------------- |
| `/users/`                | POST | email（唯一）、password（密码）、name（用户名）、inviteCode（邀请码） | id:number, email:string, name:string, role:string, status:string, intro:string, avatarLink:string, backgroundLink:string, fansCount:number, followingCount:number, following:number[] | 无需登录 | 插入user（新建用户） |
| `/users/{userId}`       | GET  | 无                                                          | id:number, email:string, name:string, role:string, status:string, intro:string, avatarLink:string, backgroundLink:string, fansCount:number, followingCount:number, following:number[] | 无需登录 | 查询user（用户信息） |
| `/users/simple`         | GET  | userIds（数组参数）                                          | [{id:number, name:string, avatarLink:string}, ...] | 无需登录 | 查询一些人的简单信息 |
| `/users/`               | PUT  | name（可选）、intro（可选）等用户资料信息                    | null                                           | 需登录   | 更新user（本人信息） |
| `/users/changePassword` | PUT  | oldPassword newPassword                                      | null                                           | 需登录   | 更新user（密码信息） |

#### 返回值格式示例(仅供参考)

```json
// 用户注册成功返回
{
  "code": 200,
  "success": true,
  "message": "注册成功",
  "data": {
    "id": 1,
    "email": "user@example.com",
    "name": "用户名",
    "role": "USER",
    "status": "NORMAL",
    "intro": "个人介绍",
    "avatarLink": "https://example.com/avatar.jpg",
    "backgroundLink": "https://example.com/background.jpg",
    "fansCount": 0,
    "followingCount": 0,
    "following": []
  }
}

// 获取用户信息成功返回
{
  "code": 200,
  "success": true,
  "message": "获取用户信息成功",
  "data": {
    "id": 1,
    "email": "user@example.com",
    "name": "用户名",
    "role": "USER",
    "status": "NORMAL",
    "intro": "个人介绍",
    "avatarLink": "https://example.com/avatar.jpg",
    "backgroundLink": "https://example.com/background.jpg",
    "fansCount": 100,
    "followingCount": 50,
    "following": [2, 3, 5]
  }
}

// 获取简单用户信息成功返回
{
  "code": 200,
  "success": true,
  "message": "获取用户信息成功",
  "data": [
    {
      "id": 1,
      "name": "用户名1",
      "avatarLink": "https://example.com/avatar1.jpg"
    },
    {
      "id": 2,
      "name": "用户名2",
      "avatarLink": "https://example.com/avatar2.jpg"
    }
  ]
}

// 更新用户资料成功返回
{
  "code": 200,
  "success": true,
  "message": "修改成功",
  "data": null
}

// 修改密码成功返回
{
  "code": 200,
  "success": true,
  "message": "修改成功",
  "data": null
}
```

#### 2.2 管理员操作 finished

| 路径                           | 方法 | 入参                                                     | 出参                                 | 权限        | 表操作               |
| ------------------------------ | ---- | -------------------------------------------------------- | ------------------------------------ | ----------- | -------------------- |
| `/users/admin/`                 | GET  | page（页码）、pageSize（每页大小）                       | total:number, data:[用户信息数组]    | 风纪/管理员 | 获取所有用户列表     |
| `/users/admin/{userId}/role`   | PUT  | role（ADMIN/MODERATOR，直接传字符串字面量）              | null                                 | 管理员      | 更新user（用户角色） |
| `/users/admin/{userId}/status` | PUT  | status（NORMAL/UNABLE，直接传字符串字面量）              | null                                 | 风纪/管理员 | 更新user（用户状态） |
| `/users/admin/{userId}/reset`  | PUT  | 无                                                       | null                                 | 管理员      | 更新user（密码哈希） |

#### 返回值格式示例（仅供参考）

```json
// 获取用户列表成功返回
{
  "code": 200,
  "success": true,
  "message": "获取用户列表成功",
  "data": {
    "total": 100,
    "data": [
      {
        "id": 1,
        "email": "user1@example.com",
        "name": "用户名1",
        "role": "USER",
        "status": "NORMAL",
        "intro": "个人介绍1",
        "avatarLink": "https://example.com/avatar1.jpg",
        "backgroundLink": "https://example.com/background1.jpg",
        "fansCount": 50,
        "followingCount": 25
      },
      {
        "id": 2,
        "email": "user2@example.com",
        "name": "用户名2",
        "role": "ADMIN",
        "status": "NORMAL",
        "intro": "个人介绍2",
        "avatarLink": "https://example.com/avatar2.jpg",
        "backgroundLink": "https://example.com/background2.jpg",
        "fansCount": 100,
        "followingCount": 50,
      }
    ]
  }
}

// 修改用户角色成功返回
{
  "code": 200,
  "success": true,
  "message": "修改角色成功",
  "data": null
}

// 修改用户状态成功返回
{
  "code": 200,
  "success": true,
  "message": "修改用户状态成功",
  "data": null
}

// 重置密码成功返回
{
  "code": 200,
  "success": true,
  "message": "密码重置成功",
  "data": null
}
```

### 3. 帖子接口（/posts）

此接口定义用户如何发帖，修改帖子内容，获取帖子列表，删掉帖子（软删掉），管理员审核帖子，管理员或者风纪给帖子加精。帖子状态有status（PENDING/PASS/REJECT/DELETE）

#### 3.1 帖子操作 finished

| 路径              | 方法   | 入参                                                         | 出参                                                         | 权限                   | 表操作               |
| ----------------- | ------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ---------------------- | -------------------- |
| `/posts`          | POST   | title（标题）、content（内容）、clubId（可选，圈子ID）       | id:number, title:string, content:string, clubId:number, userId:number, status:string, createdAt:string, updatedAt:string, viewCount:number, likeCount:number, dislikeCount:number, commentCount:number, isEssence:boolean | 需登录                 | 插入post（新建帖子） |
| `/posts`          | GET    | keyword（可选）、cursor（游标）、pageSize（每页大小）、clubId（可选）、userId（可选）、isEssence（可选） 游标分页形式 | {data:[帖子列表], cursor:number<br>注意不获取帖子内容，并且是游标分页 | null, hasMore:boolean} | 无（公开帖列表）     |
| `/posts/{postId}` | GET    | 无                                                           | id:number, title:string, content:string, clubId:number, userId:number, status:string, createdAt:string, updatedAt:string, viewCount:number, likeCount:number, dislikeCount:number, commentCount:number, isEssence:boolean | 无（公开帖）           | 查询post（帖子详情） |
| `/posts/{postId}` | PUT    | title（可选）、content（可选）等帖子内容                     | null                                                         | 需登录（本人）         | 更新post（本人帖子） |
| `/posts/{postId}` | DELETE | 无                                                           | null                                                         | 需登录（本人）         | 更新post（标记删除） |

#### 返回值格式示例（仅供参考）

```json
// 发布帖子成功返回
{
  "code": 200,
  "success": true,
  "message": "发布成功",
  "data": null
}

// 获取帖子列表成功返回
{
  "code": 200,
  "success": true,
  "message": "获取帖子列表成功",
  "data": {
    "data": [
      {
        "id": 1,
        "title": "帖子标题1",
        //"content": "帖子内容1", // 不获取帖子内容
        "clubId": 1,
        "userId": 1,
        "status": "PASS",
        "createdAt": "2023-01-01T00:00:00Z",
        "updatedAt": "2023-01-01T00:00:00Z",
        "viewCount": 100,
        "likeCount": 10,
        "dislikeCount": 2,
        "commentCount": 5,
        "isEssence": true,
        "interactContent": 0 // (用户的点赞态度)
      },
      {
        "id": 2,
        "title": "帖子标题2",
        //"content": "帖子内容2",
        "clubId": 1,
        "userId": 2,
        "status": "PASS",
        "createdAt": "2023-01-02T00:00:00Z",
        "updatedAt": "2023-01-02T00:00:00Z",
        "viewCount": 50,
        "likeCount": 5,
        "dislikeCount": 1,
        "commentCount": 3,
        "isEssence": false,
        "interactContent": 0 // 用户的点赞态度
      }
    ],
    "cursor": 2,  // 游标分页
    "hasMore": true
  }
}

// 获取帖子详情成功返回
{
  "code": 200,
  "success": true,
  "message": "获取帖子详情成功",
  "data": {
    "id": 1,
    "title": "帖子标题",
    "content": "帖子内容",
    "clubId": 1,
    "userId": 1,
    "status": "PASS",
    "createdAt": "2023-01-01T00:00:00Z",
    "updatedAt": "2023-01-01T00:00:00Z",
    "viewCount": 100,
    "likeCount": 10,
    "dislikeCount": 2,
    "commentCount": 5,
    "isEssence": true
  }
}

// 修改帖子成功返回
{
  "code": 200,
  "success": true,
  "message": "修改成功",
  "data": null
}

// 删除帖子成功返回
{
  "code": 200,
  "success": true,
  "message": "删除成功",
  "data": null
}
```

#### 3.2 帖子权限操作（管理员/风纪）finished

| 路径                            | 方法 | 入参                                                         | 出参                         | 权限        | 表操作               |
| ------------------------------- | ---- | ------------------------------------------------------------ | ---------------------------- | ----------- | -------------------- |
| `/posts/admin`                  | GET  | keyword（可选）、page（页码）、pageSize（每页大小）、clubId（可选）、userIds（可选）、isEssence（可选）、status（帖子状态，可选） | {total, data（帖子列表）}    | 管理员/风纪 | 查询post列表         |
| `/posts/admin/{postId}/audit`   | PUT  | status（PASS/REJECT/DELETE，直接传字符串字面量）             | code:200、message:"审核成功" | 管理员/风纪 | 更新post（帖子状态） |
| `/posts/admin/{postId}/essence` | PUT  | isEssence（布尔值，true/false）                               | code:200、message:"操作成功" | 管理员/风纪 | 更新post（精华状态） |


#### 返回值格式示例（仅供参考）

```json
// 获取管理员帖子列表成功返回
{
  "code": 200,
  "success": true,
  "message": "获取帖子列表成功",
  "data": {
    "total": 100,
    "data": [
      {
        "id": 1,
        "title": "帖子标题1",
        "content": "帖子内容1",
        "clubId": 1,
        "userId": 1,
        "status": "PENDING",
        "createdAt": "2023-01-01T00:00:00Z",
        "updatedAt": "2023-01-01T00:00:00Z",
        "viewCount": 100,
        "likeCount": 10,
        "dislikeCount": 2,
        "commentCount": 5,
        "isEssence": false
      },
      {
        "id": 2,
        "title": "帖子标题2",
        "content": "帖子内容2",
        "clubId": 1,
        "userId": 2,
        "status": "PASS",
        "createdAt": "2023-01-02T00:00:00Z",
        "updatedAt": "2023-01-02T00:00:00Z",
        "viewCount": 50,
        "likeCount": 5,
        "dislikeCount": 1,
        "commentCount": 3,
        "isEssence": true
      }
    ]
  }
}

// 审核帖子成功返回
{
  "code": 200,
  "success": true,
  "message": "审核成功",
  "data": null
}

// 设置精华成功返回
{
  "code": 200,
  "success": true,
  "message": "操作成功",
  "data": null
}
```

### 4. 圈子接口（/clubs）

此接口定义了用户如何查看圈子列表，查看圈子详情，修改圈子信息，解散圈子，以及邀请/移除成员

| 路径                      | 方法   | 入参                                   | 出参                                                                 | 权限                    | 表操作               |
| ------------------------- | ------ | -------------------------------------- | -------------------------------------------------------------------- | ----------------------- | -------------------- |
| `/clubs/`                 | GET    | page（页码）、count（每页数量）        | {data:[圈子列表], total:number}                                        | 无                      | 查询club（圈子列表） |
| `/clubs/{clubId}`         | GET    | 无                                     | id:number, name:string, description:string, creatorId:number, memberCount:number, createdAt:string, updatedAt:string | 无                      | 查询club（圈子详情） |
| `/clubs/{clubId}/members/`| POST   | userId（用户ID）                       | null                                                                 | 需登录                  | 邀请成员加入圈子    |
| `/clubs/{clubId}/members/{userId}` | DELETE | 无                       | null                                                                 | 需登录                  | 移除圈子成员        |
| `/clubs/{clubId}`         | PUT    | ClubProfileDTO（包含更新信息）         | null                                                                 | 需登录（创建者/管理员） | 更新club（圈子信息） |
| `/clubs/{clubId}`         | DELETE | 无                                     | null                                                                 | 需登录（创建者/管理员） | 删除club（圈子数据） |

#### 返回值格式示例

```json
// 获取圈子列表成功返回
{
  "code": 200,
  "success": true,
  "message": "获取圈子列表成功",
  "data": {
    "data": [
      {
        "id": 1,
        "name": "圈子名称1",
        "description": "圈子描述1",
        "creatorId": 1,
        "memberCount": 50,
        "createdAt": "2023-01-01T00:00:00Z",
        "updatedAt": "2023-01-01T00:00:00Z"
      },
      {
        "id": 2,
        "name": "圈子名称2",
        "description": "圈子描述2",
        "creatorId": 2,
        "memberCount": 30,
        "createdAt": "2023-01-02T00:00:00Z",
        "updatedAt": "2023-01-02T00:00:00Z"
      }
    ],
    "total": 100
  }
}

// 获取圈子详情成功返回
{
  "code": 200,
  "success": true,
  "message": "获取圈子详情成功",
  "data": {
    "id": 1,
    "name": "圈子名称",
    "description": "圈子描述",
    "creatorId": 1,
    "memberCount": 50,
    "createdAt": "2023-01-01T00:00:00Z",
    "updatedAt": "2023-01-01T00:00:00Z"
  }
}

// 邀请成员成功返回
{
  "code": 200,
  "success": true,
  "message": "success to send the invitation!",
  "data": null
}

// 移除成员成功返回
{
  "code": 200,
  "success": true,
  "message": "success to remove the member!",
  "data": null
}

// 更新圈子信息成功返回
{
  "code": 200,
  "success": true,
  "message": "success to update the club!",
  "data": null
}

// 删除圈子成功返回
{
  "code": 200,
  "success": true,
  "message": "success to delete the club!",
  "data": null
}
```

### 5. 评论接口（/comments）

此接口定义了用户如何评论帖子，评论帖子下方的评论，管理员审核评论（不允许修改帖子内容，删掉是软删掉）

#### 5.1 用户操作  finished

| 路径                    | 方法   | 入参                                                         | 出参                                                                 | 权限                           | 表操作                      |
| ----------------------- | ------ | ------------------------------------------------------------ | -------------------------------------------------------------------- | ------------------------------ | --------------------------- |
| `/comments`             | POST   | postId（帖子ID）、content（内容）、rootId（可空）、parentId（可空） | id:number, postId:number, content:string, userId:number, rootId:number|null, parentId:number|null, status:string, createdAt:string, updatedAt:string, likeCount:number, dislikeCount:number | 需登录                         | 插入comment（新建评论）     |
| `/comments`             | GET    | postId（必填，帖子ID）、cursor（可选，游标分页）、pageSize（必填，每页大小） | {data:[评论列表], cursor:number|null, hasMore:boolean}               | 无                             | 查询comment（评论列表）     |
| `/comments/replies`     | GET    | postId（必填，帖子ID）、cursor（可选，游标分页）、pageSize（必填，每页大小）、rootId（必填，根评论ID）、parentId（可选，父节点ID） | {data:[评论回复列表], cursor:number|null, hasMore:boolean}           | 无                             | 查询comment（评论列表）     |
| `/comments/{commentId}` | DELETE | 无                                                           | null                                                                 | 需登录（本人/MODERATOR/ADMIN） | 更新comment（is_deleted=1） |

#### 返回值格式示例（仅供参考）

```json
// 发布评论成功返回
{
  "code": 200,
  "success": true,
  "message": "评论成功",
  "data": null
}

// 获取评论列表成功返回
{
  "code": 200,
  "success": true,
  "message": "获取评论列表成功",
  "data": {
    "data": [
      {
        "id": 1,
        "postId": 1,
        "content": "评论内容1",
        "userId": 1,
        "rootId": null,
        "parentId": null,
        "status": "PASS",
        "createdAt": "2023-01-01T00:00:00Z",
        "updatedAt": "2023-01-01T00:00:00Z",
        "likeCount": 5,
        "dislikeCount": 1
      },
      {
        "id": 2,
        "postId": 1,
        "content": "评论内容2",
        "userId": 2,
        "rootId": null,
        "parentId": null,
        "status": "PASS",
        "createdAt": "2023-01-01T01:00:00Z",
        "updatedAt": "2023-01-01T01:00:00Z",
        "likeCount": 3,
        "dislikeCount": 0
      }
    ],
    "cursor": 2,
    "hasMore": true
  }
}

// 获取评论回复列表成功返回
{
  "code": 200,
  "success": true,
  "message": "获取评论回复成功",
  "data": {
    "data": [
      {
        "id": 3,
        "postId": 1,
        "content": "回复内容1",
        "userId": 3,
        "rootId": 1,
        "parentId": 1,
        "status": "PASS",
        "createdAt": "2023-01-01T02:00:00Z",
        "updatedAt": "2023-01-01T02:00:00Z",
        "likeCount": 2,
        "dislikeCount": 0
      }
    ],
    "cursor": 3,
    "hasMore": false
  }
}

// 删除评论成功返回
{
  "code": 200,
  "success": true,
  "message": "删除成功",
  "data": null
}
```

#### 5.2 管理员操作 fnished

| 路径                    | 方法 | 入参                                                         | 出参                                                | 权限        | 表操作                  |
| ----------------------- | ---- | ------------------------------------------------------------ | --------------------------------------------------- | ----------- | ----------------------- |
| `/comments/admin`       | GET  | page（页码）、pageSize（每页大小）、status（可选，评论状态）等筛选参数 | {total:number, data:[评论列表]}                     | 管理员/风纪 | 查询comment列表        |
| `/comments/admin/content` | GET | commentIds涉及的所有评论 | [评论列表] | 管理员/风纪 | 查询评论内容            |
| `/comments/admin/audit` | PUT  | status（PASS/REJECT/DELETE，直接传字符串字面量） commentIds涉及的所有评论id | null                                                | 管理员/风纪 | 更新comment（评论状态） |

#### 返回值格式示例（仅供参考）

```json
// 获取管理员评论列表成功返回
{
  "code": 200,
  "success": true,
  "message": "获取评论列表成功",
  "data": {
    "total": 50,
    "data": [
      {
        "id": 1,
        "postId": 1,
        "content": "评论内容1",
        "userId": 1,
        "rootId": null,
        "parentId": null,
        "status": "PENDING",
        "createdAt": "2023-01-01T00:00:00Z",
        "updatedAt": "2023-01-01T00:00:00Z",
        "likeCount": 5,
        "dislikeCount": 1
      },
      {
        "id": 2,
        "postId": 2,
        "content": "评论内容2",
        "userId": 2,
        "rootId": null,
        "parentId": null,
        "status": "PASS",
        "createdAt": "2023-01-01T01:00:00Z",
        "updatedAt": "2023-01-01T01:00:00Z",
        "likeCount": 3,
        "dislikeCount": 0
      }
    ]
  }
}

// 审核评论成功返回
{
  "code": 200,
  "success": true,
  "message": "审核完成",
  "data": null
}
```

### 6. 圈子申请接口（/applies）

此接口定义了用户如何申请创建圈子，发送加入圈子请求，管理员或者圈子主如何处理申请信息

#### 6.1 创建申请

| 路径                              | 方法 | 入参                                                         | 出参                                                | 权限        | 表操作                            |
| --------------------------------- | ---- | ------------------------------------------------------------ | --------------------------------------------------- | ----------- | --------------------------------- |
| `/applies/create`                 | POST | name（圈子名称）、description（圈子描述）                    | id:number, name:string, description:string, userId:number, status:string, createdAt:string, updatedAt:string | 需登录      | 插入club_apply_create（新建申请） |
| `/applies/create/admin/{applyId}` | PUT  | status（PASS/REJECT，直接传字符串字面量，即上面的内容）、handledBy（处理人ID） | null                                                | 管理员/风纪 | 更新club_apply_create（申请状态） |

#### 返回值格式示例

```json
// 创建圈子申请成功返回
{
  "code": 200,
  "success": true,
  "message": "申请成功",
  "data": {
    "id": 1,
    "name": "圈子名称",
    "description": "圈子描述",
    "userId": 1,
    "status": "PENDING",
    "createdAt": "2023-01-01T00:00:00Z",
    "updatedAt": "2023-01-01T00:00:00Z"
  }
}

// 审核创建申请成功返回
{
  "code": 200,
  "success": true,
  "message": "审核完成",
  "data": null
}
```

#### 6.2 加入申请

| 路径                      | 方法 | 入参                                                         | 出参                                                | 权限               | 表操作                          |
| ------------------------- | ---- | ------------------------------------------------------------ | --------------------------------------------------- | ------------------ | ------------------------------- |
| `/applies/join/{clubId}`  | POST | 无                                                           | id:number, clubId:number, userId:number, status:string, createdAt:string, updatedAt:string | 需登录             | 插入club_apply_join（新建申请） |
| `/applies/join/{applyId}` | PUT  | status（PASS/REJECT，直接传字符串字面量，即上面的内容）、handledBy（处理人ID） | null                                                | 圈子创建者，需登录 | 更新club_apply_join（申请状态） |

#### 返回值格式示例

```json
// 申请加入圈子成功返回
{
  "code": 200,
  "success": true,
  "message": "申请成功",
  "data": {
    "id": 1,
    "clubId": 1,
    "userId": 1,
    "status": "PENDING",
    "createdAt": "2023-01-01T00:00:00Z",
    "updatedAt": "2023-01-01T00:00:00Z"
  }
}

// 审核加入申请成功返回
{
  "code": 200,
  "success": true,
  "message": "审核完成",
  "data": null
}
```

#### 6.3 查询申请

| 路径                      | 方法 | 入参                                            | 出参                                                | 权限   | 表操作                                   |
| ------------------------- | ---- | ----------------------------------------------- | --------------------------------------------------- | ------ | ---------------------------------------- |
| `/applies/admin/{clubId}` | GET  | page（页码）pageSize（大小），type(JOIN/CREATE) | {data:[申请列表], total:number}                     | 需登录 | 查询club_apply_join或者club_apply_create |

#### 返回值格式示例

```json
// 查询申请列表成功返回
{
  "code": 200,
  "success": true,
  "message": "获取申请列表成功",
  "data": {
    "data": [
      {
        "id": 1,
        "name": "圈子名称",
        "description": "圈子描述",
        "userId": 1,
        "status": "PENDING",
        "createdAt": "2023-01-01T00:00:00Z",
        "updatedAt": "2023-01-01T00:00:00Z"
      }
    ],
    "total": 10
  }
}
```

### 7. 通知接口（/notifications）

此接口定义了用户如何获取通知信息，以及如何管理通知状态

| 路径                          | 方法 | 入参              | 出参                                                | 权限   | 表操作              |
| ----------------------------- | ---- | ----------------- | --------------------------------------------------- | ------ | ------------------- |
| `/notifications`              | GET  | page, pageSize    | {data:[通知列表], total:number}                     | 需登录 | 查询notifications   |
| `/notifications/{id}`         | PUT  | 无                | null                                                | 需登录 | 更新notifications   |
| `/notifications/unread/count` | GET  | 无                | count:number                                        | 需登录 | 查询notifications   |

#### 返回值格式示例

```json
// 获取通知列表成功返回
{
  "code": 200,
  "success": true,
  "message": "获取通知列表成功",
  "data": {
    "data": [
      {
        "id": 1,
        "userId": 1,
        "type": "COMMENT",
        "content": "有人评论了你的帖子",
        "isRead": false,
        "createdAt": "2023-01-01T00:00:00Z"
      }
    ],
    "total": 10
  }
}

// 标记通知为已读成功返回
{
  "code": 200,
  "success": true,
  "message": "通知已标记为已读",
  "data": null
}

// 获取未读通知数量成功返回
{
  "code": 200,
  "success": true,
  "message": "获取未读通知数量成功",
  "data": 5
}
```

### 8. 举报接口（/reports）

此接口定义了用户如何举报帖子，用户，圈子。举报类型（）被举报的对象类型（COMMENT=评论/POST=帖子/USER=用户，直接传字符串字面量）被举报的对象ID（如帖子ID/评论ID/用户ID）

#### 8.1 普通用户操作  finished

| 路径        | 方法 | 入参                                                         | 出参                                                 | 权限   | 表操作                                               |
| ----------- | ---- | ------------------------------------------------------------ | ---------------------------------------------------- | ------ | ---------------------------------------------------- |
| `/reports/` | POST | reportType（举报类型）、reportTargetType（被举报对象类型）、reportTarget（被举报对象ID）、reason（举报理由，可选） | code:200、message:"Success to report it! Please wait for the administrators to check!" | 需登录 | 插入report（新建举报记录），发送“新举报通知”给管理员 |

#### 8.2 管理员/风纪操作 finished

| 路径             | 方法 | 入参                                                         | 出参                                   | 权限        | 表操作                                                       |
| ---------------- | ---- | ------------------------------------------------------------ | -------------------------------------- | ----------- | ------------------------------------------------------------ |
| `/reports/admin` | GET  | page（页码）、pageSize（页面大小）、reportTargetType（举报目标类型，可选）、status（举报处理状态，可选） | 举报列表数据 | 管理员/风纪 | 查询report                                   |
| `/reports/admin` | POST  | status（处理状态）、reportIds（涉及的所有举报内容）          | code:200、message:"Success to handle reports!"       | 管理员/风纪 | 更新report（处理状态+处理人+处理时间）；若status=PROCESSED，联动处理被举报对象（如帖子/评论置为REJECT），发送“举报处理结果通知”给举报人 |

### 9. 互动接口（/interactions）

此接口用于记录用户对帖子、评论、用户的点赞/踩操作，以及对用户的关注操作。

**约束说明**：

- 同一用户对同一对象的互动操作需限制频率（1分钟内最多5次）
- 互动类型 `interactType` 枚举值：POST（帖子）、USER（用户）、COMMENT（评论）
- 互动内容 `interactContent` 取值说明：
  - 对于 POST/COMMENT 类型：-1（踩）、0（无互动）、1（赞）
  - 对于 USER 类型：0（未关注）、1（已关注）

#### 9.1 互动操作（点赞/踩/关注）finished

| 路径            | 方法 | 入参                                                         | 出参                        | 权限   | 表操作                                  |
| --------------- | ---- | ------------------------------------------------------------ | --------------------------- | ------ | --------------------------------------- |
| `/interactions` | POST | interactType（互动类型）、interactId（被互动对象ID）、interactContent（互动状况） | null                        | 需登录 | 若记录存在则更新互动内容，否则创建新记录 |

#### 返回值格式示例

```json
// 互动操作成功返回
{
  "code": 200,
  "success": true,
  "message": "操作成功",
  "data": null
}
```

#### 9.2 互动记录查询（暂不实现）

| 路径                      | 方法 | 入参 | 出参                | 权限   | 表操作                         |
| ------------------------- | ---- | ---- | ------------------- | ------ | ------------------------------ |
| `/interactions/following` | GET  | 无   | userIds所有关注的人 | 需登录 | 查询本人互动记录，根据条件筛选 |
| `/interactions/followers` | GET  | 无   |                     |        |                                |

### 10. 邀请码接口（/invitecode）

此接口定义了用户和管理员对邀请码的操作，包括获取、生成、更新和删除邀请码。

#### 10.1 用户操作 finished

| 路径                | 方法 | 入参   | 出参                                   | 权限   | 表操作               |
| ------------------- | ---- | ------ | -------------------------------------- | ------ | -------------------- |
| `/invitecode/`  | GET  | 无（Token放Cookie）     | [邀请码列表] | 需登录 | 查询用户的邀请码列表 |

#### 10.2 管理员操作 finished

| 路径                   | 方法 | 入参                                                         | 出参                                 | 权限    | 表操作               |
| ---------------------- | ---- | ------------------------------------------------------------ | ------------------------------------ | ------- | -------------------- |
| `/invitecode/admin` | GET  | page（页码）、pageSize（每页大小）                       | {data:[邀请码列表], total:number} | 管理员 | 查询所有邀请码列表   |
| `/invitecode/admin` | POST | count（生成数量）、expiredDays（过期时间）、maxCount（最大使用次数） | [邀请码列表] | 管理员 | 生成新邀请码         |
| `/invitecode/admin` | PUT | codes（邀请码列表）、maxCount（最多使用次数）, expiredDays（过期次数） | null | 管理员 | 修改邀请码使用时间或者过期时间 |
| `/invitecode/admin` | DELETE | codes 邀请码列表                                 | null | 管理员 | 删除邀请码           |

#### 返回值格式示例

```json
// 获取用户邀请码列表成功返回
{
  "code": 200,
  "success": true,
  "message": "获取邀请码列表成功",
  "data": [
    {
      "code": "ABC123",
      "creatorId": 1,
      "createdAt": "2023-01-01T00:00:00Z",
      "expiredAt": "2023-12-31T23:59:59Z",
      "maxCount": 10,
      "usedCount": 3
    }
  ]
}

// 管理员获取邀请码分页列表成功返回
{
  "code": 200,
  "success": true,
  "message": "获取邀请码列表成功",
  "data": {
    "data": [
      {
        "code": "ABC123",
        "creatorId": 1,
        "createdAt": "2023-01-01T00:00:00Z",
        "expiredAt": "2023-12-31T23:59:59Z",
        "maxCount": 10,
        "usedCount": 3
      }
    ],
    "total": 100
  }
}

// 管理员生成邀请码成功返回
{
  "code": 200,
  "success": true,
  "message": "生成邀请码成功",
  "data": [
    {
      "code": "XYZ789",
      "creatorId": 1,
      "createdAt": "2023-01-01T00:00:00Z",
      "expiredAt": "2023-12-31T23:59:59Z",
      "maxCount": 5,
      "usedCount": 0
    }
  ]
}

// 管理员更新邀请码成功返回
{
  "code": 200,
  "success": true,
  "message": "更新邀请码成功",
  "data": null
}

// 管理员删除邀请码成功返回
{
  "code": 200,
  "success": true,
  "message": "删除邀请码成功",
  "data": null
}
```

